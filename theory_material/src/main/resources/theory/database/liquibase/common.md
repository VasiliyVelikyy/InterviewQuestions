# Preconditions

В Liquibase, preconditions (предусловия) — это механизм, который позволяет проверять определенные условия перед
выполнением изменений в базе данных. Они используются для того, чтобы убедиться, что изменения могут быть безопасно
применены, или чтобы предотвратить выполнение изменений в неподходящих условиях.

## Основные цели preconditions:

1) Проверка состояния базы данных:
   Например, убедиться, что определенная таблица или колонка существует (или не существует) перед выполнением изменений.
2) Защита от ошибок:
   Предотвратить выполнение изменений, которые могут привести к ошибкам, если база данных находится в неподходящем
   состоянии.
3) Гибкость:
   Позволяют адаптировать выполнение изменений в зависимости от текущего состояния базы данных.

## Типы preconditions:

Liquibase поддерживает множество типов предусловий, например:

- Проверка наличия таблицы: <tableExists>
- Проверка наличия колонки: <columnExists>
- Проверка версии базы данных: <dbms>
- Проверка выполнения предыдущих изменений: <changeSetExecuted>
- Проверка наличия определенного значения: <sqlCheck>

Пример использования preconditions:

```xml

<changeSet id="1" author="me">
    <preConditions>
        <tableExists tableName="old_table"/>
    </preConditions>
    <comment>Удаляем таблицу old_table, если она существует</comment>
    <dropTable tableName="old_table"/>
</changeSet>
```

### В этом примере:

- Сначала проверяется, существует ли таблица old_table.
- Если таблица существует, то выполняется изменение — удаление таблицы.
- Если таблица не существует, изменение пропускается.
- Действия при невыполнении предусловий:
  Если предусловие не выполняется, Liquibase может:
- Пропустить изменение (по умолчанию).
- Остановить выполнение с ошибкой.
- Выполнить альтернативное изменение (если указано).

#### Настройка поведения:

Вы можете указать, как Liquibase должен реагировать на невыполнение предусловий, используя атрибут onFail:

- onFail="HALT" — остановить выполнение.
- onFail="CONTINUE" — продолжить выполнение.
- onFail="MARK_RAN" — пометить изменение как выполненное, но не применять его.

```xml

<preConditions onFail="HALT">
    <tableExists tableName="required_table"/>
</preConditions>
```